---

title: Data

keywords: fastai
sidebar: home_sidebar

summary: "This module defines tools for image data preprocessing and real-time data augmentation that is used to train a model."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Orininal Paper:</strong> Falk, Thorsten, et al. "U-Net: deep learning for cell counting, detection, and morphometry." Nature methods 16.1 (2019): 67-70.</p>
<p><strong>The code was provided by the authors and adapted for this package.</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deformation-field-class-for-data-augmentation">Deformation field class for data augmentation<a class="anchor-link" href="#Deformation-field-class-for-data-augmentation">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DeformationField" class="doc_header"><code>class</code> <code>DeformationField</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/data.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DeformationField</code>(<strong><code>shape</code></strong>=<em><code>(540, 540)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Pre-Processor">Data Pre Processor<a class="anchor-link" href="#Data-Pre-Processor">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataPreProcessor" class="doc_header"><code>class</code> <code>DataPreProcessor</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/data.py#L95" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataPreProcessor</code>(<strong><code>element_size_um</code></strong>=<em><code>None</code></em>, <strong><code>border_weight_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>foreground_dist_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>border_weight_factor</code></strong>=<em><code>50</code></em>, <strong><code>foreground_background_ratio</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Augmentation-Generator">Data Augmentation Generator<a class="anchor-link" href="#Data-Augmentation-Generator">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DataAugmentationGenerator" class="doc_header"><code>class</code> <code>DataAugmentationGenerator</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/data.py#L240" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataAugmentationGenerator</code>(<strong><code>data</code></strong>, <strong><code>tile_shape</code></strong>, <strong><code>padding</code></strong>, <strong><code>instancelabels</code></strong>=<em><code>None</code></em>, <strong><code>classlabels</code></strong>=<em><code>None</code></em>, <strong><code>n_classes</code></strong>=<em><code>2</code></em>, <strong><code>ignore</code></strong>=<em><code>None</code></em>, <strong><code>weights</code></strong>=<em><code>None</code></em>, <strong><code>batch_size</code></strong>=<em><code>1</code></em>, <strong><code>element_size_um</code></strong>=<em><code>None</code></em>, <strong><code>rotation_range_deg</code></strong>=<em><code>(0, 0)</code></em>, <strong><code>flip</code></strong>=<em><code>None</code></em>, <strong><code>deformation_grid</code></strong>=<em><code>None</code></em>, <strong><code>deformation_magnitude</code></strong>=<em><code>(0, 0)</code></em>, <strong><code>value_minimum_range</code></strong>=<em><code>(0, 0)</code></em>, <strong><code>value_maximum_range</code></strong>=<em><code>(1, 1)</code></em>, <strong><code>value_slope_range</code></strong>=<em><code>(1, 1)</code></em>, <strong><code>shuffle</code></strong>=<em><code>True</code></em>, <strong><code>foreground_dist_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>border_weight_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>border_weight_factor</code></strong>=<em><code>50</code></em>, <strong><code>foreground_background_ratio</code></strong>=<em><code>0.1</code></em>) :: <code>Sequence</code></p>
</blockquote>
<p>data - A list of tuples of the form
       [{ rawdata: numpy.ndarray (HxWxC),
          element_size_um: [e_y, e_x] }, ...]
       containing the raw data ([0-1] normalized) and corresponding
       element sizes in micrometers
instancelabels - A list containing the corresponding instance labels.
                 0 = background, 1-m instance labels
tile_shape - The tile shape the network expects as input
padding - The padding (input shape - output shape)
classlabels - A list containing the corresponding class labels.
              0 = ignore, 1 = background, 2-n foreground classes
              If None, the problem will be treated as binary segmentation
n_classes - The number of classes including background
ignore - A list containing the corresponding ignore regions.
weights - A list containing the corresponding weights.
element_size_um - The target pixel size in micrometers
batch_size - The number of tiles to generate per batch
rotation_range_deg - (alpha_min, alpha_max): The range of rotation angles.
                     A random rotation is drawn from a uniform distribution
                     in the given range
flip - If true, a coin flip decides whether a mirrored tile will be
       generated
deformation_grid - (dx, dy): The distance of neighboring grid points in
                   pixels for which random deformation vectors are drawn
deformation_magnitude - (sx, sy): The standard deviations of the
                        Gaussians, the components of the deformation
                        vector are drawn from
value_minimum_range - (v_min, v_max): Input intensity zero will be mapped
                      to a random value in the given range
value_maximum_range - (v_min, v_max): Input intensity one will be mapped
                      to a random value within the given range
value_slope_range - (s_min, s_max): The slope at control points is drawn
                    from a uniform distribution in the given range
border_weight_sigma_px - The border weight standard deviation in pixels
border_weight_factor - The border weight factor to enforce instance
                       separation
foreground_background_ratio - The ratio between foreground and background
                              pixels</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tile-Generator">Tile Generator<a class="anchor-link" href="#Tile-Generator">&#182;</a></h2><p>For validation and prediction.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TileGenerator" class="doc_header"><code>class</code> <code>TileGenerator</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/data.py#L441" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TileGenerator</code>(<strong><code>data</code></strong>, <strong><code>tile_shape</code></strong>, <strong><code>padding</code></strong>, <strong><code>instancelabels</code></strong>=<em><code>None</code></em>, <strong><code>classlabels</code></strong>=<em><code>None</code></em>, <strong><code>n_classes</code></strong>=<em><code>2</code></em>, <strong><code>ignore</code></strong>=<em><code>None</code></em>, <strong><code>weights</code></strong>=<em><code>None</code></em>, <strong><code>element_size_um</code></strong>=<em><code>None</code></em>, <strong><code>foreground_dist_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>border_weight_sigma_px</code></strong>=<em><code>6</code></em>, <strong><code>border_weight_factor</code></strong>=<em><code>50</code></em>, <strong><code>foreground_background_ratio</code></strong>=<em><code>0.1</code></em>) :: <code>Sequence</code></p>
</blockquote>
<p>data - A list of tuples of the form
       [{ rawdata: numpy.ndarray (HxWxC),
          element_size_um: [e_y, e_x] }, ...]
       containing the raw data ([0-1] normalized) and corresponding
       element sizes in micrometers
instancelabels - A list containing the corresponding instance labels.
                 0 = background, 1-m instance labels
tile_shape - The tile shape the network expects as input
padding - The padding (input shape - output shape)
classlabels - A list containing the corresponding class labels.
               0 = ignore, 1 = background, 2-n foreground classes
               If None, the problem will be treated as binary segmentation
n_classes - The number of classes including background
ignore - A list containing the corresponding ignore regions.
weights - A list containing the corresponding weights.
element_size_um - The target pixel size in micrometers
border_weight_sigma_px - The border weight standard deviation in pixels
border_weight_factor - The border weight factor to enforce instance
                       separation
foreground_background_ratio - The ratio between foreground and background
                              pixels</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

