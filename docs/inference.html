---

title: Inference


keywords: fastai
sidebar: home_sidebar

summary: "Classes for inference with model ensembles using Torchscript."
description: "Classes for inference with model ensembles using Torchscript."
nb_path: "nbs/04_inference.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_inference.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h2><p>Gaussian weighting for merging different predictions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe7c0f43810>" class="doc_header"><code>ScriptFunction object at 0x7fe7c0f43810></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe7c0f43810></code>()</p>
</blockquote>
<p>Returns a Gaussian window</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe7c0f437c0>" class="doc_header"><code>ScriptFunction object at 0x7fe7c0f437c0></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe7c0f437c0></code>()</p>
</blockquote>
<p>Returns a 2D Gaussian kernel tensor.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gw</span> <span class="o">=</span> <span class="n">gaussian_kernel_2d</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span><span class="mi">256</span><span class="p">),</span> <span class="n">sigma_scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">gw</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gw</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculation of epistemic and aleatoric uncertainy</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe7c0f40950>" class="doc_header"><code>ScriptFunction object at 0x7fe7c0f40950></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe7c0f40950></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe7c0f40d10>" class="doc_header"><code>ScriptFunction object at 0x7fe7c0f40d10></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe7c0f40d10></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ScriptFunction object at 0x7fe7c0f40bd0>" class="doc_header"><code>ScriptFunction object at 0x7fe7c0f40bd0></code><a href="" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ScriptFunction object at 0x7fe7c0f40bd0></code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tiling">Tiling<a class="anchor-link" href="#Tiling"> </a></h2><p>Functions and classes for tiling (slicing) images</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_in_slices_1d" class="doc_header"><code>get_in_slices_1d</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_in_slices_1d</code>(<strong><code>center</code></strong>:<code>Tensor</code>, <strong><code>len_x</code></strong>:<code>int</code>, <strong><code>len_tile</code></strong>:<code>int</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_out_slices_1d" class="doc_header"><code>get_out_slices_1d</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_out_slices_1d</code>(<strong><code>center</code></strong>:<code>Tensor</code>, <strong><code>len_x</code></strong>:<code>int</code>, <strong><code>len_tile</code></strong>:<code>int</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TileModule" class="doc_header"><code>class</code> <code>TileModule</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L74" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TileModule</code>(<strong><code>tile_shape</code></strong>=<em><code>(512, 512)</code></em>, <strong><code>scale</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>border_padding_factor</code></strong>:<code>float</code>=<em><code>0.25</code></em>, <strong><code>max_tile_shift</code></strong>:<code>float</code>=<em><code>0.5</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Class for tiling data.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="mi">540</span>
<span class="n">os</span> <span class="o">=</span> <span class="n">ts</span><span class="o">/</span><span class="mi">2</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">TileModule</span><span class="p">(</span><span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">))</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="p">(</span><span class="n">os</span><span class="p">,</span><span class="n">os</span><span class="p">))[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">image</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-04</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]</span>
<span class="n">SCALES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]</span>
<span class="n">SHIFTS</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
<span class="n">BPFACTORS</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">TS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">SCALES</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">max_tile_shift</span> <span class="ow">in</span> <span class="n">SHIFTS</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">border_padding_factor</span> <span class="ow">in</span> <span class="n">BPFACTORS</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">TileModule</span><span class="p">(</span><span class="n">tile_shape</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">max_tile_shift</span><span class="o">=</span><span class="n">max_tile_shift</span><span class="p">,</span> <span class="n">border_padding_factor</span><span class="o">=</span><span class="n">border_padding_factor</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">t</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">unsqueeze_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">in_slices</span><span class="p">,</span> <span class="n">out_slices</span><span class="p">,</span> <span class="n">center_points</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_slices_and_centers</span><span class="p">(</span><span class="n">inp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">center_points</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">center_points</span><span class="p">):</span>
                    <span class="n">ix0</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">iy0</span><span class="p">,</span> <span class="n">iy1</span> <span class="o">=</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">in_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">ox0</span><span class="p">,</span> <span class="n">ox1</span><span class="p">,</span> <span class="n">oy0</span><span class="p">,</span> <span class="n">oy1</span> <span class="o">=</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">out_slices</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="p">(</span><span class="n">ix1</span><span class="o">-</span><span class="n">ix0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">ox1</span><span class="o">-</span><span class="n">ox0</span><span class="p">),</span> <span class="s1">&#39;Input/Output slices do not match&#39;</span>
                    <span class="k">assert</span> <span class="p">(</span><span class="n">iy1</span><span class="o">-</span><span class="n">iy0</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">oy1</span><span class="o">-</span><span class="n">oy0</span><span class="p">),</span> <span class="s1">&#39;Input/Output slices do not match&#39;</span>
                    <span class="n">tile</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">cp</span><span class="p">)</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">ox0</span><span class="p">:</span><span class="n">ox1</span><span class="p">,</span> <span class="n">oy0</span><span class="p">:</span><span class="n">oy1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">tile</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">ix0</span><span class="p">:</span><span class="n">ix1</span><span class="p">,</span> <span class="n">iy0</span><span class="p">:</span><span class="n">iy1</span><span class="p">]</span>
                    <span class="c1">#plt.imshow(out)</span>
                    <span class="c1">#plt.show()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
    <span class="n">t_scripted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">ost</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">os</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;TileModule.onnx&#39;</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">t_scripted</span><span class="p">,</span> <span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">ost</span><span class="p">,</span> <span class="n">ost</span><span class="p">])),</span> <span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opset_version</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.13.0.dev20220601
Exported graph: graph(%x.1 : Float(540, 540, 1, strides=[540, 1, 1], requires_grad=0, device=cpu),
      %center.1 : Float(2, strides=[1], requires_grad=0, device=cpu)):
  %onnx::Gather_2 : Long(device=cpu) = onnx::Constant[value={0}, onnx_name=&#34;Constant_0&#34;]()
  %onnx::Gather_3 : Long(device=cpu) = onnx::Constant[value={1}, onnx_name=&#34;Constant_1&#34;]()
  %onnx::Sub_4 : Float(device=cpu) = onnx::Gather[axis=0, onnx_name=&#34;Gather_2&#34;](%center.1, %onnx::Gather_2) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Sub_5 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={270}, onnx_name=&#34;Constant_3&#34;]() # /tmp/ipykernel_1860785/989343441.py:55:41
  %onnx::Div_6 : Float(device=cpu) = onnx::Sub[onnx_name=&#34;Sub_4&#34;](%onnx::Sub_4, %onnx::Sub_5) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Div_7 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={270}, onnx_name=&#34;Constant_5&#34;]() # /tmp/ipykernel_1860785/989343441.py:55:41
  %relative_center : Float(device=cpu) = onnx::Div[onnx_name=&#34;Div_6&#34;](%onnx::Div_6, %onnx::Div_7) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Add_9 : Float(1024, 1024, strides=[1024, 1], requires_grad=0, device=cpu) = onnx::Constant[value=&lt;Tensor&gt;, onnx_name=&#34;Constant_7&#34;]() # /tmp/ipykernel_1860785/989343441.py:56:22
  %coords : Float(1024, 1024, strides=[1024, 1], device=cpu) = onnx::Add[onnx_name=&#34;Add_8&#34;](%onnx::Add_9, %relative_center) # /tmp/ipykernel_1860785/989343441.py:56:22
  %onnx::Unsqueeze_11 : Float(1024, 1024, strides=[1024, 1], device=cpu) = onnx::Cast[to=1, onnx_name=&#34;Cast_9&#34;](%coords) # /tmp/ipykernel_1860785/989343441.py:57:25
  %onnx::Sub_12 : Float(device=cpu) = onnx::Gather[axis=0, onnx_name=&#34;Gather_10&#34;](%center.1, %onnx::Gather_3) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Sub_13 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={270}, onnx_name=&#34;Constant_11&#34;]() # /tmp/ipykernel_1860785/989343441.py:55:41
  %onnx::Div_14 : Float(device=cpu) = onnx::Sub[onnx_name=&#34;Sub_12&#34;](%onnx::Sub_12, %onnx::Sub_13) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Div_15 : Float(requires_grad=0, device=cpu) = onnx::Constant[value={270}, onnx_name=&#34;Constant_13&#34;]() # /tmp/ipykernel_1860785/989343441.py:55:41
  %relative_center.3 : Float(device=cpu) = onnx::Div[onnx_name=&#34;Div_14&#34;](%onnx::Div_14, %onnx::Div_15) # /tmp/ipykernel_1860785/989343441.py:55:31
  %onnx::Add_17 : Float(1024, 1024, strides=[1024, 1], requires_grad=0, device=cpu) = onnx::Constant[value=&lt;Tensor&gt;, onnx_name=&#34;Constant_15&#34;]() # /tmp/ipykernel_1860785/989343441.py:56:22
  %coords.3 : Float(1024, 1024, strides=[1024, 1], device=cpu) = onnx::Add[onnx_name=&#34;Add_16&#34;](%onnx::Add_17, %relative_center.3) # /tmp/ipykernel_1860785/989343441.py:56:22
  %onnx::Unsqueeze_19 : Float(1024, 1024, strides=[1024, 1], device=cpu) = onnx::Cast[to=1, onnx_name=&#34;Cast_17&#34;](%coords.3) # /tmp/ipykernel_1860785/989343441.py:57:25
  %onnx::Unsqueeze_20 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name=&#34;Constant_18&#34;]() # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Concat_21 : Float(1024, 1024, 1, strides=[1024, 1, 1], device=cpu) = onnx::Unsqueeze[onnx_name=&#34;Unsqueeze_19&#34;](%onnx::Unsqueeze_19, %onnx::Unsqueeze_20) # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Unsqueeze_22 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={-1}, onnx_name=&#34;Constant_20&#34;]() # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Concat_23 : Float(1024, 1024, 1, strides=[1024, 1, 1], device=cpu) = onnx::Unsqueeze[onnx_name=&#34;Unsqueeze_21&#34;](%onnx::Unsqueeze_11, %onnx::Unsqueeze_22) # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Cast_24 : Float(1024, 1024, 2, strides=[2048, 2, 1], device=cpu) = onnx::Concat[axis=-1, onnx_name=&#34;Concat_22&#34;](%onnx::Concat_21, %onnx::Concat_23) # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Unsqueeze_25 : Float(1024, 1024, 2, strides=[2048, 2, 1], device=cpu) = onnx::Cast[to=1, onnx_name=&#34;Cast_23&#34;](%onnx::Cast_24) # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Unsqueeze_26 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name=&#34;Constant_24&#34;]() # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::GridSample_27 : Float(1, 1024, 1024, 2, strides=[2097152, 2048, 2, 1], device=cpu) = onnx::Unsqueeze[onnx_name=&#34;Unsqueeze_25&#34;](%onnx::Unsqueeze_25, %onnx::Unsqueeze_26) # /tmp/ipykernel_1860785/989343441.py:60:16
  %onnx::Unsqueeze_28 : Float(1, 540, 540, strides=[291600, 540, 1], device=cpu) = onnx::Transpose[perm=[2, 0, 1], onnx_name=&#34;Transpose_26&#34;](%x.1) # /tmp/ipykernel_1860785/989343441.py:63:12
  %onnx::Unsqueeze_29 : Long(1, strides=[1], device=cpu) = onnx::Constant[value={0}, onnx_name=&#34;Constant_27&#34;]() # /tmp/ipykernel_1860785/989343441.py:63:12
  %onnx::GridSample_30 : Float(1, 1, 540, 540, strides=[291600, 291600, 540, 1], device=cpu) = onnx::Unsqueeze[onnx_name=&#34;Unsqueeze_28&#34;](%onnx::Unsqueeze_28, %onnx::Unsqueeze_29) # /tmp/ipykernel_1860785/989343441.py:63:12
  %x : Float(1, 1, 1024, 1024, strides=[1048576, 1048576, 1024, 1], requires_grad=0, device=cpu) = onnx::GridSample[align_corners=1, mode=&#34;bilinear&#34;, padding_mode=&#34;reflection&#34;, onnx_name=&#34;GridSample_29&#34;](%onnx::GridSample_30, %onnx::GridSample_27) # /home/magr/.conda/envs/pytorch/lib/python3.10/site-packages/torch/nn/functional.py:4181:11
  return (%x)

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inference-Ensemble">Inference Ensemble<a class="anchor-link" href="#Inference-Ensemble"> </a></h2><p>Scripable module for inference with multiple models</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="InferenceEnsemble" class="doc_header"><code>class</code> <code>InferenceEnsemble</code><a href="https://github.com/matjesg/deepflash2/tree/master/deepflash2/inference.py#L143" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>InferenceEnsemble</code>(<strong><code>models</code></strong>:<code>List</code>[<code>Module</code>], <strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>in_channels</code></strong>:<code>int</code>, <strong><code>channel_means</code></strong>:<code>List</code>[<code>float</code>], <strong><code>channel_stds</code></strong>:<code>List</code>[<code>float</code>], <strong><code>tile_shape</code></strong>:<code>Tuple</code>[<code>int</code>, <code>int</code>]=<em><code>(512, 512)</code></em>, <strong><code>use_gaussian</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>gaussian_kernel_sigma_scale</code></strong>:<code>float</code>=<em><code>0.125</code></em>, <strong><code>use_tta</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>border_padding_factor</code></strong>:<code>float</code>=<em><code>0.25</code></em>, <strong><code>max_tile_shift</code></strong>:<code>float</code>=<em><code>0.9</code></em>, <strong><code>scale</code></strong>:<code>float</code>=<em><code>1.0</code></em>, <strong><code>device</code></strong>:<code>str</code>=<em><code>'cuda:0'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Class for model ensemble inference</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DummyModule</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="s1">&#39;Dummy Module for testing&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="n">num_classes</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[:,:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_classes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CHANNELS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">SCALES</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]</span>
<span class="n">IMG_SHAPES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">512</span><span class="p">]</span><span class="c1">#[256, 512, 1024]</span>

<span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">CHANNELS</span><span class="p">:</span>
    <span class="n">channel_means</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span><span class="o">*</span><span class="n">ch</span>
    <span class="n">channel_stds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="o">*</span><span class="n">ch</span>
    <span class="k">for</span> <span class="n">num_classes</span> <span class="ow">in</span> <span class="n">NUM_CLASSES</span><span class="p">:</span>
        <span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">DummyModule</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">sx</span> <span class="ow">in</span> <span class="n">IMG_SHAPES</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sy</span> <span class="ow">in</span> <span class="n">IMG_SHAPES</span><span class="p">:</span>
                <span class="n">inp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">SCALES</span><span class="p">:</span>
                    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">InferenceEnsemble</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> 
                                                 <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">,</span> 
                                                 <span class="n">in_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                                 <span class="n">channel_means</span><span class="o">=</span><span class="n">channel_means</span><span class="p">,</span>
                                                 <span class="n">channel_stds</span><span class="o">=</span><span class="n">channel_stds</span><span class="p">,</span> 
                                                 <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
                    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
                    <span class="n">outs</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
                    <span class="n">test_eq</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_pt</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;ensemble.pt&#39;</span><span class="p">)</span>
<span class="n">scripted_ensemble</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
<span class="n">scripted_ensemble</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path_pt</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_pt</span><span class="p">)</span>
<span class="n">path_pt</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
    <span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;inp&quot;</span><span class="p">]</span>
    <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;argmax&quot;</span><span class="p">,</span> <span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="s2">&quot;stdeviation&quot;</span><span class="p">]</span>
    <span class="n">dynamic_axes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;inp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;argmax&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;softmax&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;stdeviation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="n">path_onnx</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;ensemble.onnx&#39;</span><span class="p">)</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">scripted_ensemble</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">path_onnx</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opset_version</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> 
                      <span class="n">input_names</span><span class="o">=</span><span class="n">input_names</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="n">output_names</span><span class="p">,</span> <span class="n">dynamic_axes</span><span class="o">=</span><span class="n">dynamic_axes</span><span class="p">)</span>
    
    <span class="c1">#import onnxruntime</span>
    <span class="c1">#ort_session = onnxruntime.InferenceSession(path_onnx.as_posix())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

